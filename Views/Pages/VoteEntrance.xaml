<UserControl
    x:Class="_2025æ¯•ä¸šè®¾è®¡.Views.Pages.VoteEntrance"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:common="clr-namespace:_2025æ¯•ä¸šè®¾è®¡.Common"
    xmlns:converter="clr-namespace:_2025æ¯•ä¸šè®¾è®¡.Converter"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:local="clr-namespace:_2025æ¯•ä¸šè®¾è®¡.Views.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:prism="http://prismlibrary.com/"
    d:DesignHeight="680"
    d:DesignWidth="980"
    prism:ViewModelLocator.AutoWireViewModel="True"
    mc:Ignorable="d">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/2025æ¯•ä¸šè®¾è®¡;component/Dict/ConverterDict.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <!--  å†…ç½®è½¬æ¢å™¨  -->
            <converter:BooleanInvertConverter x:Key="BooleanInvertConverter"/>
            <BooleanToVisibilityConverter x:Key="BoolToVisConverter" />
            <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />

            <!--  é¡µé¢ä¸“ç”¨è½¬æ¢å™¨  -->
            <converter:ObjectToBooleanConverter x:Key="ObjectToBooleanConverter" />
            <converter:ByteArrayToImageConverter x:Key="ByteArrayToImageConverter" />

            <!--  é˜´å½±æ•ˆæžœ  -->
            <DropShadowEffect
                x:Key="EffectShadow2"
                BlurRadius="10"
                Direction="270"
                ShadowDepth="2"
                Color="#22000000" />

            <!--  å·²æŠ•ç¥¨å¡ç‰‡è¾¹æ¡†æ ·å¼  -->
            <Style x:Key="VotedCardStyle" TargetType="Border">
                <Setter Property="BorderBrush" Value="#DDDDDD" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Background" Value="White" />
                <Style.Triggers>
                    <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Grid}}" Value="True">
                        <Setter Property="BorderBrush" Value="#E53935" />
                        <Setter Property="BorderThickness" Value="2" />
                        <Setter Property="Background" Value="#FFF3F3" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <!--  æŠ•ç¥¨æŒ‰é’®æ ·å¼  -->
            <Style x:Key="VoteButtonStyle" TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border
                                x:Name="BorderRoot"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="30">
                                <ContentPresenter
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Content="{TemplateBinding Content}" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Cursor" Value="Hand" />
                                    <Setter TargetName="BorderRoot" Property="Opacity" Value="0.9" />
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="BorderRoot" Property="Opacity" Value="0.8" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="BorderRoot" Property="Opacity" Value="0.4" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!--  é»˜è®¤å¥–é¡¹èµ„æº  -->
            <ImageSource x:Key="DefaultAvatarImage">/2025æ¯•ä¸šè®¾è®¡;component/Images/é»˜è®¤å¥–é¡¹.jpg</ImageSource>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  é¡¶éƒ¨èƒŒæ™¯å’Œæ ‡é¢˜  -->
        <StackPanel
            Grid.Row="0"
            Height="130"
            VerticalAlignment="Top">
            <StackPanel.Background>
                <ImageBrush ImageSource="/2025æ¯•ä¸šè®¾è®¡;component/Images/æŠ•ç¥¨å…¥å£.jpg" Stretch="UniformToFill" />
            </StackPanel.Background>
        </StackPanel>
        <Label
            Width="150"
            Height="80"
            Background="Transparent"
            BorderThickness="0"
            Content="æŠ•ç¥¨å…¥å£"
            FontSize="30"
            FontWeight="Bold"
            Foreground="Black" />

        <!--  å¥–é¡¹é€‰æ‹©åŒºåŸŸ  -->
        <Grid Grid.Row="1" Margin="20,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="250" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBlock
                Grid.Column="0"
                Margin="0,0,10,0"
                VerticalAlignment="Center"
                FontSize="16"
                Text="ç­›é€‰å¥–é¡¹:" />

            <!--  æ”¹è¿›çš„ComboBoxï¼Œå¯ç”¨å†…ç½®è‡ªåŠ¨è¡¥å…¨  -->
            <ComboBox
                x:Name="AwardComboBox"
                Grid.Column="1"
                Width="200"
                Margin="10,0,0,0"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                DisplayMemberPath="AwardName"
                IsEditable="True"
                ItemsSource="{Binding Awards}"
                MaxDropDownHeight="300"
                SelectedItem="{Binding SelectedAward}"
                Style="{StaticResource ComboBoxBaseStyle}"
                Text="{Binding SearchedAwardName, UpdateSourceTrigger=PropertyChanged}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="PreviewKeyDown">
                        <i:InvokeCommandAction Command="{Binding ComboBoxPreviewKeyDownCommand}" PassEventArgsToCommand="True" />
                    </i:EventTrigger>
                    <i:EventTrigger EventName="KeyDown">
                        <i:InvokeCommandAction Command="{Binding ComboBoxKeyDownCommand}" PassEventArgsToCommand="True" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </ComboBox>

            <TextBlock
                Grid.Column="2"
                Margin="20,0,10,0"
                VerticalAlignment="Center"
                FontSize="16"
                Text="æœç´¢:" />

            <!--  æ·»åŠ æœç´¢å…³é”®è¯è¾“å…¥æ¡†  -->
            <TextBox
                Grid.Column="3"
                MinWidth="120"
                Margin="0,0,10,0"
                VerticalAlignment="Center"
                hc:InfoElement.Placeholder="è¾“å…¥å…³é”®è¯æœç´¢æå..."
                Style="{StaticResource TextBoxBaseStyle}"
                Text="{Binding SearchKeyword, UpdateSourceTrigger=PropertyChanged}" />

            <Button
                Grid.Column="4"
                Margin="10,0,0,0"
                Padding="10,5"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Background="#2196F3"
                BorderThickness="0"
                Command="{Binding SearchCommand}"
                Content="æœç´¢"
                Foreground="White"
                ToolTip="æœç´¢" />
        </Grid>

        <!--  ä¸»æ»šåŠ¨åŒºåŸŸ  -->
        <ScrollViewer
            x:Name="MainScrollViewer"
            Grid.Row="2"
            Padding="0,0,0,0"
            HorizontalScrollBarVisibility="Disabled"
            VerticalScrollBarVisibility="Auto">
            <Grid>
                <!--  åŠ è½½æŒ‡ç¤ºå™¨  -->
                <Grid Panel.ZIndex="999" Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisConverter}}">
                    <Grid MinHeight="300" Background="#80FFFFFF">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <!--  ä½¿ç”¨æ ‡å‡†æŽ§ä»¶æ›¿ä»£hc:LoadingCircle  -->
                            <ProgressBar
                                Width="50"
                                Height="50"
                                Foreground="#2196F3"
                                IsIndeterminate="True" />
                            <TextBlock
                                Margin="0,10,0,0"
                                FontSize="14"
                                Foreground="#333333"
                                Text="æ­£åœ¨åŠ è½½æ•°æ®..." />
                        </StackPanel>
                    </Grid>
                </Grid>

                <!--  æååˆ—è¡¨åŒºåŸŸ  -->
                <ItemsControl
                    x:Name="NominationsItemsControl"
                    Height="Auto"
                    Margin="20,0,20,100"
                    ItemsSource="{Binding PagedNominations}"
                    PreviewMouseWheel="Control_PreviewMouseWheel"
                    VirtualizingPanel.CacheLength="2,2"
                    VirtualizingPanel.CacheLengthUnit="Page"
                    VirtualizingPanel.ScrollUnit="Pixel"
                    VirtualizingStackPanel.IsVirtualizing="True"
                    VirtualizingStackPanel.VirtualizationMode="Recycling">
                    <!--  æ”¹è¿›çš„ItemsControlæ¨¡æ¿ï¼Œé˜²æ­¢æ»šåŠ¨äº‹ä»¶è¢«å†…éƒ¨æ•èŽ·  -->
                    <ItemsControl.Template>
                        <ControlTemplate>
                            <Border
                                Padding="{TemplateBinding Padding}"
                                Background="Transparent"
                                BorderThickness="0">
                                <!--  ç¦ç”¨å†…éƒ¨æ»šåŠ¨ï¼Œå®Œå…¨ä¾èµ–å¤–éƒ¨ScrollViewer  -->
                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                        </ControlTemplate>
                    </ItemsControl.Template>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel Orientation="Vertical" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid HorizontalAlignment="Center">
                                <Grid.Tag>
                                    <Binding Path="IsUserVoted" />
                                </Grid.Tag>

                                <!--  ä½¿ç”¨StackPanelåž‚ç›´å¸ƒå±€ï¼Œè®©è¯„è®ºåŒºåœ¨å¡ç‰‡ä¸‹æ–¹  -->
                                <StackPanel>
                                    <!--  æåå¡ç‰‡  -->
                                    <Border
                                        Width="600"
                                        Margin="0,5,0,10"
                                        Padding="10"
                                        CornerRadius="5"
                                        Style="{StaticResource VotedCardStyle}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="MouseLeftButtonDown">
                                                <i:InvokeCommandAction Command="{Binding DataContext.ViewNominationDetailsCommand, ElementName=NominationsItemsControl}" CommandParameter="{Binding}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <!--  æåå›¾ç‰‡å’Œç¼–å·  -->
                                            <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                                <Border
                                                    Width="100"
                                                    Height="100"
                                                    ClipToBounds="True"
                                                    CornerRadius="50">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="#F0F0F0" />
                                                    </Border.Background>
                                                    <Grid>
                                                        <!--  é»˜è®¤å¥–é¡¹ä½œä¸ºåº•å±‚  -->
                                                        <Image Source="/2025æ¯•ä¸šè®¾è®¡;component/Images/é»˜è®¤å¥–é¡¹.jpg" Stretch="UniformToFill">
                                                            <Image.Clip>
                                                                <EllipseGeometry
                                                                    Center="50,50"
                                                                    RadiusX="50"
                                                                    RadiusY="50" />
                                                            </Image.Clip>
                                                            <Image.Style>
                                                                <Style TargetType="Image">
                                                                    <Setter Property="Visibility" Value="Visible" />
                                                                    <Style.Triggers>
                                                                        <!--  å½“CoverImageä¸ä¸ºnullæ—¶éšè—é»˜è®¤å›¾ç‰‡  -->
                                                                        <DataTrigger Binding="{Binding Path=CoverImage, Converter={StaticResource ObjectToBooleanConverter}}" Value="True">
                                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Image.Style>
                                                        </Image>

                                                        <!--  ä½¿ç”¨Nominationçš„CoverImage  -->
                                                        <Image Source="{Binding CoverImage, Converter={StaticResource ByteArrayToImageConverter}}" Stretch="UniformToFill">
                                                            <Image.Clip>
                                                                <EllipseGeometry
                                                                    Center="50,50"
                                                                    RadiusX="50"
                                                                    RadiusY="50" />
                                                            </Image.Clip>
                                                            <Image.Style>
                                                                <Style TargetType="Image">
                                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <!--  å½“CoverImageä¸ä¸ºnullæ—¶æ˜¾ç¤º  -->
                                                                        <DataTrigger Binding="{Binding Path=CoverImage, Converter={StaticResource ObjectToBooleanConverter}}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Image.Style>
                                                        </Image>
                                                    </Grid>
                                                </Border>

                                                <!--  æåç¼–å·  -->
                                                <TextBlock
                                                    Margin="0,5,0,0"
                                                    HorizontalAlignment="Center"
                                                    FontSize="12"
                                                    Foreground="#757575"
                                                    Text="{Binding NominationId, StringFormat=ç¼–å·: {0}}" />
                                            </StackPanel>

                                            <!--  æåä¿¡æ¯  -->
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <!--  æ·»åŠ æ˜¾ç¤ºå¥–é¡¹åç§°  -->
                                                <StackPanel Margin="0,0,0,5" Orientation="Horizontal">
                                                    <TextBlock
                                                        FontSize="14"
                                                        FontWeight="Bold"
                                                        Foreground="#1976D2"
                                                        Text="{Binding Award.AwardName, StringFormat='å¥–é¡¹: {0}', TargetNullValue='å¥–é¡¹: æœªçŸ¥'}" />
                                                </StackPanel>

                                                <TextBlock>
                                                    <Run
                                                        FontSize="18"
                                                        FontWeight="Bold"
                                                        Text="{Binding NominatedEmployee.EmployeeName, TargetNullValue='æœªæŒ‡å®šå‘˜å·¥'}" />
                                                    <Run
                                                        FontSize="18"
                                                        FontWeight="Bold"
                                                        Text="{Binding NominatedAdmin.AdminName, TargetNullValue=''}" />
                                                </TextBlock>

                                                <TextBlock
                                                    Margin="0,0,0,5"
                                                    FontSize="14"
                                                    Text="{Binding Department.DepartmentName, StringFormat='éƒ¨é—¨: {0}', TargetNullValue='éƒ¨é—¨: æœªæŒ‡å®š'}" />

                                                <TextBlock
                                                    Margin="0,0,0,5"
                                                    FontSize="14"
                                                    Text="{Binding Introduction, StringFormat='ç®€ä»‹: {0}', TargetNullValue='ç®€ä»‹: æš‚æ— '}"
                                                    TextWrapping="Wrap" />

                                                <TextBlock
                                                    FontSize="14"
                                                    Text="{Binding NominateReason, StringFormat='æåç†ç”±: {0}', TargetNullValue='æåç†ç”±: æš‚æ— '}"
                                                    TextWrapping="Wrap" />
                                            </StackPanel>

                                            <!--  æŠ•ç¥¨æŒ‰é’®  -->
                                            <StackPanel
                                                Grid.Column="2"
                                                Margin="15,0,0,0"
                                                VerticalAlignment="Center">
                                                <Button
                                                    x:Name="VoteButton"
                                                    Width="60"
                                                    Height="60"
                                                    Margin="0,0,0,15"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    hc:FloatingBlock.Duration="0:0:1"
                                                    hc:FloatingBlock.ToX="0"
                                                    hc:FloatingBlock.ToY="-80"
                                                    hc:FloatingBlock.VerticalOffset="-20"
                                                    Background="#2196F3"
                                                    BorderThickness="0"
                                                    Command="{Binding DataContext.VoteCommand, ElementName=NominationsItemsControl}"
                                                    CommandParameter="{Binding}"
                                                    IsEnabled="{Binding DataContext.IsSuperAdmin, ElementName=NominationsItemsControl, Converter={StaticResource BooleanInvertConverter}}"
                                                    Foreground="White">
                                                    <Button.Tag>
                                                        <Binding Path="IsUserVoted" />
                                                    </Button.Tag>
                                                    <Button.Style>
                                                        <Style BasedOn="{StaticResource VoteButtonStyle}" TargetType="Button">
                                                            <Setter Property="Background" Value="#2196F3" />
                                                            <Setter Property="ToolTip" Value="ç‚¹å‡»æŠ•ç¥¨" />
                                                            <Setter Property="Effect">
                                                                <Setter.Value>
                                                                    <DropShadowEffect
                                                                        BlurRadius="10"
                                                                        Direction="270"
                                                                        ShadowDepth="2"
                                                                        Color="#22000000" />
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource Self}}" Value="True">
                                                                    <Setter Property="Background" Value="#E53935" />
                                                                    <Setter Property="ToolTip" Value="æ‚¨å·²ç»æŠ•è¿‡ç¥¨äº†" />
                                                                    <Setter Property="Effect">
                                                                        <Setter.Value>
                                                                            <DropShadowEffect
                                                                                BlurRadius="12"
                                                                                Direction="270"
                                                                                ShadowDepth="3"
                                                                                Color="#44FF0000" />
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding DataContext.IsSuperAdmin, ElementName=NominationsItemsControl}" Value="True">
                                                                    <Setter Property="Background" Value="#E53935" />
                                                                    <Setter Property="ToolTip" Value="è¶…çº§ç®¡ç†å‘˜ä»…å¯æŸ¥çœ‹ï¼Œä¸èƒ½æŠ•ç¥¨" />
                                                                    <Setter Property="Effect">
                                                                        <Setter.Value>
                                                                            <DropShadowEffect
                                                                                BlurRadius="12"
                                                                                Direction="270"
                                                                                ShadowDepth="3"
                                                                                Color="#44FF0000" />
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                    <StackPanel>
                                                        <!--  ç¬¬ä¸€ä¸ªTextBlock (å›¾æ ‡)  -->
                                                        <TextBlock
                                                            HorizontalAlignment="Center"
                                                            FontSize="24"
                                                            FontWeight="Bold"
                                                            Text="ðŸ‘">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=Button}}" Value="True">
                                                                            <Setter Property="Text" Value="âœ“" />
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding DataContext.IsSuperAdmin, ElementName=NominationsItemsControl}" Value="True">
                                                                            <Setter Property="Text" Value="ðŸ‘ï¸" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>

                                                        <!--  ç¬¬äºŒä¸ªTextBlock (æ–‡æœ¬)  -->
                                                        <TextBlock
                                                            Margin="0,2,0,0"
                                                            HorizontalAlignment="Center"
                                                            FontSize="12"
                                                            FontWeight="SemiBold"
                                                            Text="æŠ•ç¥¨">
                                                            <TextBlock.Style>
                                                                <Style TargetType="TextBlock">
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=Button}}" Value="True">
                                                                            <Setter Property="Text" Value="å·²æŠ•" />
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding DataContext.IsSuperAdmin, ElementName=NominationsItemsControl}" Value="True">
                                                                            <Setter Property="Text" Value="æŸ¥çœ‹" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBlock.Style>
                                                        </TextBlock>
                                                    </StackPanel>
                                                    <hc:FloatingBlock.ContentTemplate>
                                                        <DataTemplate>
                                                            <!--  ä½¿ç”¨å›ºå®šTextå€¼ï¼Œé¿å…å¤æ‚ç»‘å®šå¯¼è‡´çš„Freezableé”™è¯¯  -->
                                                            <TextBlock
                                                                FontSize="24"
                                                                FontWeight="Bold"
                                                                Foreground="#FF4081"
                                                                Text="ðŸ‘" />
                                                        </DataTemplate>
                                                    </hc:FloatingBlock.ContentTemplate>
                                                </Button>

                                                <!--  è¯„è®ºæŒ‰é’®  -->
                                                <hc:Badge
                                                    Width="60"
                                                    Height="60"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    BadgeMargin="0,-14,-14,0"
                                                    Style="{DynamicResource BadgeInfo}"
                                                    Value="{Binding CommentCount}">
                                                    <Button
                                                        x:Name="CommentButton"
                                                        Width="60"
                                                        Height="60"
                                                        Background="#4CAF50"
                                                        BorderThickness="0"
                                                        Command="{Binding DataContext.ShowCommentsCommand, ElementName=NominationsItemsControl}"
                                                        CommandParameter="{Binding}"
                                                        Foreground="White"
                                                        Style="{StaticResource VoteButtonStyle}">
                                                        <StackPanel>
                                                            <TextBlock
                                                                HorizontalAlignment="Center"
                                                                FontSize="24"
                                                                FontWeight="Bold"
                                                                Text="ðŸ’¬" />
                                                            <TextBlock
                                                                Margin="0,2,0,0"
                                                                HorizontalAlignment="Center"
                                                                FontSize="12"
                                                                FontWeight="SemiBold"
                                                                Text="è¯„è®º" />
                                                        </StackPanel>
                                                    </Button>
                                                </hc:Badge>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!--  è¯„è®ºåŒºåŸŸ - æ”¾åœ¨ä¸»å¡ç‰‡ä¸‹æ–¹è€Œä¸æ˜¯è¦†ç›–å®ƒ  -->
                                    <Border
                                        x:Name="CommentSection"
                                        Width="600"
                                        Margin="0,0,0,30"
                                        Padding="15"
                                        Background="White"
                                        BorderBrush="#DDDDDD"
                                        BorderThickness="1"
                                        CornerRadius="5"
                                        Effect="{StaticResource EffectShadow2}"
                                        Visibility="{Binding IsCommentSectionVisible, Converter={StaticResource BoolToVisConverter}, UpdateSourceTrigger=PropertyChanged}">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <!--  è¯„è®ºåŒºæ ‡é¢˜å’Œå…³é—­æŒ‰é’®  -->
                                            <Grid Grid.Row="0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>

                                                <TextBlock
                                                    Grid.Column="0"
                                                    Margin="0,0,0,10"
                                                    FontSize="16"
                                                    FontWeight="Bold"
                                                    Text="è¯„è®ºåŒº" />

                                                <Button
                                                    Grid.Column="1"
                                                    Width="80"
                                                    Background="#E53935"
                                                    BorderThickness="0"
                                                    Command="{Binding DataContext.HideCommentsCommand, ElementName=NominationsItemsControl}"
                                                    CommandParameter="{Binding}"
                                                    Content="æ”¶èµ·"
                                                    Foreground="White" />
                                            </Grid>

                                            <!--  è¯„è®ºåˆ—è¡¨  -->
                                            <Grid Grid.Row="1">
                                                <ScrollViewer
                                                    MaxHeight="300"
                                                    PreviewMouseWheel="Control_PreviewMouseWheel"
                                                    VerticalScrollBarVisibility="Auto">
                                                    <StackPanel>
                                                        <ItemsControl ItemsSource="{Binding UIComments}">
                                                            <ItemsControl.ItemTemplate>
                                                                <DataTemplate>
                                                                    <Border
                                                                        Margin="0,5"
                                                                        Padding="10"
                                                                        BorderBrush="#EEEEEE"
                                                                        BorderThickness="0,0,0,1">
                                                                        <Grid>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="Auto" />
                                                                                <ColumnDefinition Width="*" />
                                                                                <ColumnDefinition Width="Auto" />
                                                                            </Grid.ColumnDefinitions>

                                                                            <!--  è¯„è®ºè€…å¤´åƒ  -->
                                                                            <Border
                                                                                Grid.Column="0"
                                                                                Width="40"
                                                                                Height="40"
                                                                                Margin="0,0,10,0"
                                                                                ClipToBounds="True"
                                                                                CornerRadius="20">
                                                                                <Grid>
                                                                                    <!--  é»˜è®¤å¥–é¡¹  -->
                                                                                    <Image Source="/2025æ¯•ä¸šè®¾è®¡;component/Images/é»˜è®¤å¥–é¡¹.jpg" Stretch="UniformToFill">
                                                                                        <Image.Clip>
                                                                                            <EllipseGeometry
                                                                                                Center="20,20"
                                                                                                RadiusX="20"
                                                                                                RadiusY="20" />
                                                                                        </Image.Clip>
                                                                                    </Image>

                                                                                    <!--  ç®¡ç†å‘˜å¤´åƒ  -->
                                                                                    <Image Source="{Binding CommenterAdmin.AdminImage, Converter={StaticResource ByteArrayToImageConverter}}" Stretch="UniformToFill">
                                                                                        <Image.Clip>
                                                                                            <EllipseGeometry
                                                                                                Center="20,20"
                                                                                                RadiusX="20"
                                                                                                RadiusY="20" />
                                                                                        </Image.Clip>
                                                                                        <Image.Style>
                                                                                            <Style TargetType="Image">
                                                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                                                                <Style.Triggers>
                                                                                                    <DataTrigger Binding="{Binding CommenterAdminId, Converter={StaticResource ObjectToBooleanConverter}}" Value="True">
                                                                                                        <Setter Property="Visibility" Value="Visible" />
                                                                                                    </DataTrigger>
                                                                                                </Style.Triggers>
                                                                                            </Style>
                                                                                        </Image.Style>
                                                                                    </Image>

                                                                                    <!--  è¶…çº§ç®¡ç†å‘˜å¤´åƒ  -->
                                                                                    <Image Source="{Binding CommenterSupAdmin.SupAdminImage, Converter={StaticResource ByteArrayToImageConverter}}" Stretch="UniformToFill">
                                                                                        <Image.Clip>
                                                                                            <EllipseGeometry
                                                                                                Center="20,20"
                                                                                                RadiusX="20"
                                                                                                RadiusY="20" />
                                                                                        </Image.Clip>
                                                                                        <Image.Style>
                                                                                            <Style TargetType="Image">
                                                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                                                                <Style.Triggers>
                                                                                                    <DataTrigger Binding="{Binding CommenterSupAdminId, Converter={StaticResource ObjectToBooleanConverter}}" Value="True">
                                                                                                        <Setter Property="Visibility" Value="Visible" />
                                                                                                    </DataTrigger>
                                                                                                </Style.Triggers>
                                                                                            </Style>
                                                                                        </Image.Style>
                                                                                    </Image>

                                                                                    <!--  å‘˜å·¥å¤´åƒ  -->
                                                                                    <Image Source="{Binding CommenterEmployee.EmployeeImage, Converter={StaticResource ByteArrayToImageConverter}}" Stretch="UniformToFill">
                                                                                        <Image.Clip>
                                                                                            <EllipseGeometry
                                                                                                Center="20,20"
                                                                                                RadiusX="20"
                                                                                                RadiusY="20" />
                                                                                        </Image.Clip>
                                                                                        <Image.Style>
                                                                                            <Style TargetType="Image">
                                                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                                                                <Style.Triggers>
                                                                                                    <DataTrigger Binding="{Binding CommenterEmployeeId, Converter={StaticResource ObjectToBooleanConverter}}" Value="True">
                                                                                                        <Setter Property="Visibility" Value="Visible" />
                                                                                                    </DataTrigger>
                                                                                                </Style.Triggers>
                                                                                            </Style>
                                                                                        </Image.Style>
                                                                                    </Image>
                                                                                </Grid>
                                                                            </Border>

                                                                            <!--  è¯„è®ºå†…å®¹  -->
                                                                            <StackPanel Grid.Column="1">
                                                                                <StackPanel Orientation="Horizontal">
                                                                                    <!--  ä¿®æ”¹åç§°æ˜¾ç¤ºé€»è¾‘ï¼Œä½¿ç”¨æ›´å¯é çš„æ–¹å¼æ£€æŸ¥è¯„è®ºè€…  -->
                                                                                    <TextBlock
                                                                                        FontWeight="Bold"
                                                                                        Text="{Binding CommenterEmployee.EmployeeName}"
                                                                                        Visibility="{Binding CommenterEmployeeId, Converter={StaticResource ObjectToBooleanConverter}, ConverterParameter=true, Mode=OneWay}" />
                                                                                    <TextBlock
                                                                                        FontWeight="Bold"
                                                                                        Text="{Binding CommenterAdmin.AdminName}"
                                                                                        Visibility="{Binding CommenterAdminId, Converter={StaticResource ObjectToBooleanConverter}, ConverterParameter=true, Mode=OneWay}" />
                                                                                    <TextBlock
                                                                                        FontWeight="Bold"
                                                                                        Text="{Binding CommenterSupAdmin.SupAdminName}"
                                                                                        Visibility="{Binding CommenterSupAdminId, Converter={StaticResource ObjectToBooleanConverter}, ConverterParameter=true, Mode=OneWay}" />
                                                                                    <TextBlock Margin="5,0" Text=" â€¢ " />
                                                                                    <TextBlock
                                                                                        FontSize="12"
                                                                                        Foreground="#757575"
                                                                                        Text="{Binding CommentTime, StringFormat={}{0:yyyy-MM-dd HH:mm}}" />
                                                                                </StackPanel>

                                                                                <TextBlock
                                                                                    Margin="0,5,0,0"
                                                                                    Text="{Binding Content}"
                                                                                    TextWrapping="Wrap" />

                                                                                <!--  å·²åˆ é™¤æ ‡è®°  -->
                                                                                <TextBlock
                                                                                    Margin="0,5,0,0"
                                                                                    FontStyle="Italic"
                                                                                    Foreground="#E53935"
                                                                                    Text="[æ­¤è¯„è®ºå·²è¢«åˆ é™¤]"
                                                                                    Visibility="{Binding IsDeleted, Converter={StaticResource BoolToVisConverter}}" />
                                                                            </StackPanel>

                                                                            <!--  åˆ é™¤æŒ‰é’® (ä»…å¯¹ç®¡ç†å‘˜å’Œè¶…çº§ç®¡ç†å‘˜å¯è§)  -->
                                                                            <Button
                                                                                Grid.Column="2"
                                                                                Width="Auto"
                                                                                Height="30"
                                                                                Margin="0,0,0,0"
                                                                                Padding="8,2"
                                                                                VerticalAlignment="Center"
                                                                                Background="#E53935"
                                                                                BorderBrush="#B71C1C"
                                                                                BorderThickness="1"
                                                                                Command="{Binding DataContext.DeleteCommentCommand, ElementName=NominationsItemsControl}"
                                                                                CommandParameter="{Binding}"
                                                                                Foreground="White"
                                                                                ToolTip="åˆ é™¤æ­¤è¯„è®º"
                                                                                Visibility="{Binding DataContext.IsAdmin, ElementName=NominationsItemsControl, Converter={StaticResource BoolToVisConverter}}">
                                                                                <StackPanel Orientation="Horizontal">
                                                                                    <TextBlock
                                                                                        Margin="0,0,5,0"
                                                                                        VerticalAlignment="Center"
                                                                                        FontSize="14"
                                                                                        Text="ðŸ—‘ï¸" />
                                                                                    <TextBlock
                                                                                        VerticalAlignment="Center"
                                                                                        FontSize="12"
                                                                                        Text="åˆ é™¤" />
                                                                                </StackPanel>
                                                                            </Button>
                                                                        </Grid>
                                                                    </Border>
                                                                </DataTemplate>
                                                            </ItemsControl.ItemTemplate>
                                                        </ItemsControl>

                                                        <!--  åŠ è½½æ›´å¤šæŒ‰é’®  -->
                                                        <Button
                                                            Width="150"
                                                            Height="30"
                                                            Margin="0,10"
                                                            HorizontalAlignment="Center"
                                                            Background="#4CAF50"
                                                            BorderThickness="0"
                                                            Command="{Binding DataContext.LoadMoreCommentsCommand, ElementName=NominationsItemsControl}"
                                                            CommandParameter="{Binding}"
                                                            Content="åŠ è½½æ›´å¤šè¯„è®º"
                                                            Foreground="White"
                                                            Visibility="{Binding HasMoreComments, Converter={StaticResource BoolToVisConverter}}" />
                                                    </StackPanel>
                                                </ScrollViewer>
                                            </Grid>

                                            <!--  å‘è¡¨è¯„è®ºåŒºåŸŸ  -->
                                            <Grid Grid.Row="2" Margin="0,10,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>

                                                <TextBox
                                                    Grid.Column="0"
                                                    Height="60"
                                                    Margin="0,0,10,0"
                                                    Padding="10"
                                                    VerticalAlignment="Stretch"
                                                    VerticalContentAlignment="Top"
                                                    hc:InfoElement.Placeholder="è¯·è¾“å…¥è¯„è®ºå†…å®¹..."
                                                    Text="{Binding NewCommentText, UpdateSourceTrigger=PropertyChanged}"
                                                    TextWrapping="Wrap" />

                                                <Button
                                                    Grid.Column="1"
                                                    Width="100"
                                                    Height="60"
                                                    Background="#4CAF50"
                                                    BorderThickness="0"
                                                    Command="{Binding DataContext.AddCommentCommand, ElementName=NominationsItemsControl}"
                                                    CommandParameter="{Binding}"
                                                    Content="å‘è¡¨è¯„è®º"
                                                    Foreground="White" />
                                            </Grid>
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Grid>
        </ScrollViewer>

        <!--  åˆ†é¡µæŽ§ä»¶  -->
        <DockPanel
            Grid.Row="2"
            Margin="10,0,10,20"
            HorizontalAlignment="Center"
            VerticalAlignment="Bottom"
            Panel.ZIndex="100"
            PreviewMouseWheel="Control_PreviewMouseWheel">
            <!--  æ€»è®°å½•æ•°æ˜¾ç¤º  -->
            <Label Content="å…±" Style="{DynamicResource LabelBase}" />
            <Label Content="{Binding Nominations.Count}" Style="{DynamicResource LabelBase}" />
            <Label Content="æ¡" Style="{DynamicResource LabelBase}" />

            <!--  æ¯é¡µæ˜¾ç¤ºæ¡æ•°  -->
            <Label Content="æ¯é¡µæ˜¾ç¤º" Style="{DynamicResource LabelBase}" />
            <ComboBox
                Width="60"
                Height="25"
                FontSize="12"
                ItemsSource="{Binding PageSizeOptions}"
                SelectedItem="{Binding PageSize}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <i:InvokeCommandAction Command="{Binding PageSizeChangedCommand}" CommandParameter="{Binding SelectedItem, RelativeSource={RelativeSource AncestorType=ComboBox}}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </ComboBox>
            <Label Content="æ¡" Style="{DynamicResource LabelBase}" />

            <!--  è·³è½¬é¡µç   -->
            <TextBox
                Width="40"
                Height="25"
                Margin="5,0"
                VerticalContentAlignment="Center"
                FontSize="12"
                Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="KeyUp">
                        <i:InvokeCommandAction Command="{Binding PreviewTextInputCommand}" CommandParameter="{Binding Text, RelativeSource={RelativeSource AncestorType=TextBox}}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </TextBox>

            <!--  è·³è½¬æŒ‰é’®  -->
            <Button
                Width="50"
                Height="25"
                Margin="0,0,10,0"
                Background="#2196F3"
                BorderThickness="0"
                Command="{Binding JumpPageCommand}"
                Content="è·³è½¬"
                Foreground="White" />

            <!--  é¦–é¡µæŒ‰é’®  -->
            <Button
                Width="50"
                Height="25"
                Margin="0,0,5,0"
                Background="#2196F3"
                BorderThickness="0"
                Command="{Binding FirstPageCommand}"
                Content="é¦–é¡µ"
                Foreground="White" />

            <!--  ä¸Šä¸€é¡µæŒ‰é’®  -->
            <Button
                Width="60"
                Height="25"
                Margin="0,0,5,0"
                Background="#2196F3"
                BorderThickness="0"
                Command="{Binding PreviousPageCommand}"
                Content="ä¸Šä¸€é¡µ"
                Foreground="White" />

            <!--  é¡µç æ˜¾ç¤º  -->
            <Label
                VerticalAlignment="Center"
                Content="ç¬¬"
                Style="{DynamicResource LabelBase}" />
            <TextBlock
                VerticalAlignment="Center"
                FontWeight="Bold"
                Text="{Binding CurrentPage}" />
            <Label
                VerticalAlignment="Center"
                Content="/"
                Style="{DynamicResource LabelBase}" />
            <TextBlock
                VerticalAlignment="Center"
                FontWeight="Bold"
                Text="{Binding TotalPages}" />
            <Label
                VerticalAlignment="Center"
                Content="é¡µ"
                Style="{DynamicResource LabelBase}" />

            <!--  ä¸‹ä¸€é¡µæŒ‰é’®  -->
            <Button
                Width="60"
                Height="25"
                Margin="5,0,0,0"
                Background="#2196F3"
                BorderThickness="0"
                Command="{Binding NextPageCommand}"
                Content="ä¸‹ä¸€é¡µ"
                Foreground="White" />

            <!--  æœ«é¡µæŒ‰é’®  -->
            <Button
                Width="50"
                Height="25"
                Margin="5,0,0,0"
                Background="#2196F3"
                BorderThickness="0"
                Command="{Binding LastPageCommand}"
                Content="æœ«é¡µ"
                Foreground="White" />
        </DockPanel>
    </Grid>
</UserControl>
